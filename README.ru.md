# FishCounter

Ручной подсчёт рыб на производстве — это муторно, медленно и неточно. Существующие решения часто:

1. Дорогие - требуют спецоборудования
2. Тормозные - не справляются с высокой плотностью рыб или плохо обрабатывают быстро изменяющуюся картинку

Наш проект решает эти проблемы! Мы делаем доступный и быстрый алгоритм, который работает на обычном компьютере (Core i5) и обрабатывает 500+ кадров в секунду

## Что мы делаем?
Задача: Научить компьютер считать рыб на видео с камер наблюдения в режиме реального времени.

Условия:
- Обычные камеры (не супер-дорогие)
- Процессор Core i5
- Скорость обработки: 500+ FPS
- Реальные условия: меняющийся свет, много рыб в кадре, статичная камера

## Как это работает?
## Детекция
### Шаг 1: Отделяем рыб от фона (MOG2)
MOG2 моделирует каждый пиксель как смесь нескольких гауссовых распределений, которые постоянно обновляются. Алгоритм сравнивает новые значения пикселей с существующими распределениями, классифицируя их как фон или передний план. Это позволяет адаптироваться к изменениям освещения и отделять движущихся рыб от статичного фона в реальном времени.
- Каждый пиксель на видео анализируется по-особому
- Алгоритм сам адаптируется к изменению освещения
- Результат: Четкое выделение движущихся рыб

<img width="850" height="640" alt="mog2" src="https://github.com/user-attachments/assets/59b51e96-48cf-4061-800c-c6d01c023fe7" />

### Шаг 2: Улучшаем картинку (CLAHE)
- Умное улучшение контраста даже в мутной воде
- Работает с отдельными участками кадра
- Результат: Рыбы становятся лучше видны

### Шаг 3: Чистим и объединяем (Морфологические операции)
- Убираем "шум" и мелкие артефакты
- Заполняем дыры в контурах рыб

Результат: Аккуратные и цельные объекты для подсчета

### Пример работы

<img width="1601" height="636" alt="fish_results" src="https://github.com/user-attachments/assets/e86b0ab9-d1f3-4ba7-ad19-b0834695a70f" />


# Итоговые результаты
<img width="1037" height="441" alt="image" src="https://github.com/user-attachments/assets/3f900eec-23dd-47d1-95fe-2a0a5ab7a206" />

